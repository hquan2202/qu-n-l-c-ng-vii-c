<div class="share-overlay" (click)="closePopup()">
  <div class="share-container" (click)="$event.stopPropagation()">

    <div class="header">
      <h3>Share board</h3>
      <button class="close-btn" (click)="closePopup()">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <div class="section invite-link-box">
      <div class="link-content">
        <div class="icon-bg">
          <mat-icon>link</mat-icon>
        </div>
        <div class="link-text">
          <span>Anyone with the link can join</span>
          <small class="link-url">Copy link to share</small>
        </div>
      </div>
      <button class="copy-btn" (click)="copyLink()">
        {{ isLinkCopied ? 'Copied!' : 'Copy link' }}
      </button>
    </div>

    <div class="section input-section-wrapper">
      <div class="input-row">
        <input
          type="email"
          [(ngModel)]="emailInput"
          placeholder="Email address..."
          (keydown.enter)="inviteUser()"
          [disabled]="isLoading"
          [class.input-error]="errorMessage"
        />
        <button
          class="invite-btn"
          [disabled]="!emailInput || isLoading"
          (click)="inviteUser()"
        >
          {{ isLoading ? '...' : 'Share' }}
        </button>
      </div>

      <div class="message-box">
        <small class="error-text" *ngIf="errorMessage">
          <mat-icon class="msg-icon">error</mat-icon> {{ errorMessage }}
        </small>

        <small class="success-text" *ngIf="successMessage">
          <mat-icon class="msg-icon">check_circle</mat-icon> {{ successMessage }}
        </small>
      </div>
    </div>

    <div class="section member-list">
      <div class="member-label">Board members ({{currentMembers.length}})</div>

      <div class="member-item" *ngFor="let member of currentMembers">

        <div class="avatar-circle" [title]="member.full_name || member.email">
          <img
            *ngIf="member.avatar_url && !member.imageError"
            [src]="member.avatar_url"
            (error)="member.imageError = true"
            class="avatar-img"
            alt="avatar"
          >
          <span *ngIf="!member.avatar_url || member.imageError">
            {{ getInitials(member.full_name || member.email) }}
          </span>
        </div>

        <div class="member-info">
          <span class="name">
            {{ member.full_name || member.email }}
            </span>
          <span class="role-badge">{{ member.role }}</span>
        </div>

      </div>
    </div>

  </div>
</div>
